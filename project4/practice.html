<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RemoteRehearse ‚Äî Practice</title>
  <link rel="stylesheet" href="css/style.css"/>
  <style>

    .score-switcher{ display:flex; gap:8px; justify-content:flex-end; margin:0 0 6px; }

    .embedded-content { display:block; }
    .standalone .embedded-content { display:none; }
    .standalone-shell { display:none; grid-template-columns:280px 1fr; grid-template-rows:1fr auto; height:100vh; }
    .standalone .standalone-shell { display:grid; }
    .standalone .main-content { overflow:auto; }
  </style>
</head>
<body class="practice-only">
  <!-- ============ EMBEDDED MODE ============ -->
  <div class="embedded-content">
    <div class="page-wrapper">
      <header class="header">
        <div class="group-info">
          <div class="app-title">RemoteRehearse</div>
          <div class="members">
            <span class="member-avatar" data-group="UMD Acapella" title="UMD Acapella">A</span>
            <span class="member-avatar" data-group="Blue Note Quintet" title="Blue Note Quintet">B</span>
            <span class="member-avatar" data-group="String Society" title="String Society">C</span>
            <span class="member-count">+1</span>
          </div>
        </div>
        <div class="active-group">Active Group: UMD Acapella</div>
        <button class="search-btn">Search</button>
      </header>

      <div class="practice-layout practice-layout--single">
        <section class="score-area">
          <div class="score-switcher">
            <button class="tbtn" data-prev aria-label="Previous score" title="Previous score">‚óÄ</button>
            <button class="tbtn" data-next aria-label="Next score" title="Next score">‚ñ∂</button>
          </div>

          <h1 class="score-title" data-score-title>Ave Maria ‚Äî SATB</h1>

          <figure class="score-figure">
            <div class="score-frame">
              <!-- PDF viewer -->
              <object
                class="score-pdf"
                data-score-pdf
                data="imgs/ave-maria.pdf#page=1&zoom=page-width"
                type="application/pdf"
                aria-label="Score PDF">
                <p>
                  This browser can‚Äôt preview PDFs inline.
                  <a href="imgs/ave-maria.pdf" target="_blank" rel="noopener">Open the score</a>.
                </p>
              </object>
            </div>
            <figcaption class="score-caption" data-score-caption>Ave Maria ‚Äî SATB (PDF)</figcaption>
          </figure>
        </section>

        <!-- Transport -->
        <div class="transport" role="group" aria-label="Transport controls">
          <div class="t-section">
            <button class="tbtn" aria-label="Previous" title="Previous">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M19 5l-9 7 9 7V5z"></path><path d="M5 5v14"></path></svg>
            </button>
            <button class="tbtn" aria-label="Rewind" title="Rewind">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M11 19l-9-7 9-7v14zM22 19l-9-7 9-7v14z"></path></svg>
            </button>
            <button class="tbtn tbtn--primary" aria-label="Play/Pause" title="Play">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M8 5v14l11-7-11-7z"></path></svg>
            </button>
            <button class="tbtn" aria-label="Fast forward" title="Fast forward">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M13 5l9 7-9 7V5zM2 5l9 7-9 7V5z"></path></svg>
            </button>
          </div>

          <div class="t-progress" aria-label="Progress">
            <div class="t-progress-fill" style="--pct:32%"></div>
          </div>

          <div class="t-section">
            <button class="tbtn" aria-label="Volume" title="Volume">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H3v6h3l5 4V5z"></path><path d="M15.5 8.5a5 5 0 010 7"></path></svg>
            </button>
            <button class="tbtn" aria-label="Metronome" title="Metronome">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3l6 18H6L12 3z"></path><path d="M3 13l18-6"></path></svg>
            </button>
            <button class="tbtn" aria-label="Settings" title="Settings">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 15.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z"></path>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06A1.65 1.65 0 0015 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06A2 2 0 017.04 4.3l.06.06A1.65 1.65 0 009 4.6c.28 0 .55-.06.8-.18z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============ STANDALONE MODE ============ -->
  <div class="standalone-shell">
    <aside class="sidebar">
      <div class="nav-header">
        Navigation <button class="color-picker" title="Theme color"></button>
      </div>

      <div class="nav-section">
        <a class="nav-item" href="home.html" target="_self"><span>üìä</span><span>Dashboard</span><span class="badge">3</span></a>
        <a class="nav-item" href="library.html" target="_self"><span>üìÅ</span><span>Score Library</span></a>
        <a class="nav-item active" href="practice.html" target="_self" aria-current="page"><span>üìÅ</span><span>Practice</span></a>
        <a class="nav-item" href="settings.html" target="_self"><span>‚öôÔ∏è</span><span>Settings</span></a>
        <a class="nav-item" href="about.html" target="_self"><span aria-hidden="true">‚ÑπÔ∏è</span><span>About</span></a>
      </div>

      <div class="recents-header">Recents</div>
      <div class="nav-section">
        <a class="nav-item" href="practice.html#ave-maria" target="_self"><span>üìÅ</span><span>Ave Maria SATB</span></a>
        <a class="nav-item" href="practice.html#claire" target="_self"><span>üìÅ</span><span>Clair de Lune - Piano</span></a>
        <a class="nav-item" href="practice.html#beethoven" target="_self"><span>üìÅ</span><span>Beethoven's 5th</span></a>
      </div>

      <div class="sidebar-progress">
        <div class="progress-card">
          <h3 class="progress-title">Ave Maria Progress Report</h3>
          <div class="progress-score">4.2</div>
          <div class="meter"><div class="meter-label">Pitch</div><div class="meter-track"><div class="meter-fill" style="--w:78%"></div></div></div>
          <div class="meter"><div class="meter-label">Rhythm</div><div class="meter-track"><div class="meter-fill" style="--w:64%"></div></div></div>
          <div class="meter"><div class="meter-label">Tone</div><div class="meter-track"><div class="meter-fill" style="--w:72%"></div></div></div>
        </div>
      </div>

      <div class="user-profile">
        <div class="user-avatar"></div>
        <div><div style="font-weight:600; font-size:14px;">Blythe Schulte</div></div>
      </div>
    </aside>

    <main class="main-content">
      <div class="page-wrapper">
        <header class="header">
          <div class="group-info">
            <div class="app-title">RemoteRehearse</div>
            <div class="members">
              <span class="member-avatar" data-group="UMD Acapella" title="UMD Acapella">A</span>
              <span class="member-avatar" data-group="Blue Note Quintet" title="Blue Note Quintet">B</span>
              <span class="member-avatar" data-group="String Society" title="String Society">C</span>
              <span class="member-count">+1</span>
            </div>
          </div>
          <div class="active-group">Active Group: UMD Acapella</div>
          <button class="search-btn">Search</button>
        </header>

        <div class="practice-layout practice-layout--single">
          <section class="score-area">
            <div class="score-switcher">
              <button class="tbtn" data-prev aria-label="Previous score" title="Previous score">‚óÄ</button>
              <button class="tbtn" data-next aria-label="Next score" title="Next score">‚ñ∂</button>
            </div>

            <h1 class="score-title" data-score-title>Ave Maria ‚Äî SATB</h1>

            <figure class="score-figure">
              <div class="score-frame">
                <object
                  class="score-pdf"
                  data-score-pdf
                  data="imgs/ave-maria.pdf#page=1&zoom=page-width"
                  type="application/pdf"
                  aria-label="Score PDF">
                  <p>
                    This browser can‚Äôt preview PDFs inline.
                    <a href="imgs/ave-maria.pdf" target="_blank" rel="noopener">Open the score</a>.
                  </p>
                </object>
              </div>
              <figcaption class="score-caption" data-score-caption>Ave Maria ‚Äî SATB (PDF)</figcaption>
            </figure>
          </section>

          <div class="t-progress" aria-label="Progress">
            <div class="t-progress-fill" style="--pct:32%"></div>
          </div>

          <div class="t-section">
            <button class="tbtn" aria-label="Volume" title="Volume">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H3v6h3l5 4V5z"></path><path d="M15.5 8.5a5 5 0 010 7"></path></svg>
            </button>
            <button class="tbtn" aria-label="Metronome" title="Metronome">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3l6 18H6L12 3z"></path><path d="M3 13l18-6"></path></svg>
            </button>
            <button class="tbtn" aria-label="Settings" title="Settings">
              <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 15.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z"></path>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06A1.65 1.65 0 0015 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06A2 2 0 017.04 4.3l.06.06A1.65 1.65 0 009 4.6c.28 0 .55-.06.8-.18z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </main>

    <!-- Bottom transport  -->
    <div class="transport">
      <div class="t-section">
        <button class="tbtn" aria-label="Previous" title="Previous"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M19 5l-9 7 9 7V5z"></path><path d="M5 5v14"></path></svg></button>
        <button class="tbtn" aria-label="Rewind" title="Rewind"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M11 19l-9-7 9-7v14zM22 19l-9-7 9-7v14z"></path></svg></button>
        <button class="tbtn tbtn--primary" aria-label="Play" title="Play"><svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor"><path d="M8 5v14l11-7-11-7z"></path></svg></button>
        <button class="tbtn" aria-label="Fast forward" title="Fast forward"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M13 5l9 7-9 7V5zM2 5l9 7-9 7V5z"></path></svg></button>
      </div>
      <div class="t-progress"><div class="t-progress-fill" style="--pct:32%"></div></div>
      <div class="t-section">
        <button class="tbtn" aria-label="Volume" title="Volume"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H3v6h3l5 4V5z"></path><path d="M15.5 8.5a5 5 0 010 7"></path></svg></button>
        <button class="tbtn" aria-label="Metronome" title="Metronome"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3l6 18H6L12 3z"></path><path d="M3 13l18-6"></path></svg></button>
        <button class="tbtn" aria-label="Settings" title="Settings"><svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 15.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7z"></path><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06A1.65 1.65 0 0015 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06A2 2 0 017.04 4.3l.06.06A1.65 1.65 0 009 4.6c.28 0 .55-.06.8-.18z"></path></svg></button>
      </div>
    </div>
  </div>

  <script>
  // === Score list ===
  (function(){
    const SCORES = [
      { id:'ave-maria', title:'Ave Maria ‚Äî SATB',            pdf:'imgs/ave-maria.pdf' },
      { id:'beethoven', title:"Beethoven‚Äôs 5th ‚Äî Piano",     pdf:'imgs/beethoven-5th.pdf' },
      { id:'koko',      title:'Charlie Parker ‚Äî Koko',        pdf:'imgs/Charlie-Parker-Koko.pdf' },
      { id:'claire',    title:'Clair de Lune ‚Äî Piano',       pdf:'imgs/claire-de-lune.pdf' }
    ];


    document.querySelectorAll('.practice-layout').forEach((scope) => {
      const pdfEl   = scope.querySelector('[data-score-pdf]');
      const titleEl = scope.querySelector('[data-score-title]');
      const capEl   = scope.querySelector('[data-score-caption]');
      const prevBtn = scope.querySelector('[data-prev]');
      const nextBtn = scope.querySelector('[data-next]');
      if(!pdfEl || !titleEl || !prevBtn || !nextBtn) return;

      // Pick initial score from hash 
      const startId = (location.hash || '').slice(1);
      let idx = SCORES.findIndex(s => s.id === startId);
      if (idx < 0) idx = 0;

      function render(){
        const s = SCORES[idx];
        titleEl.textContent = s.title;
        if (capEl) capEl.textContent = s.title + ' (PDF)';
        pdfEl.setAttribute('data', s.pdf + '#page=1&zoom=page-width');
        history.replaceState(null, '', '#' + s.id);
      }

      prevBtn.addEventListener('click', () => { idx = (idx - 1 + SCORES.length) % SCORES.length; render(); });
      nextBtn.addEventListener('click', () => { idx = (idx + 1) % SCORES.length; render(); });


      scope.tabIndex = -1;
      scope.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft')  prevBtn.click();
        if (e.key === 'ArrowRight') nextBtn.click();
      });
      scope.focus({preventScroll: true});

      render();
    });
  })();
  </script>

  <script>

    if (window.top === window.self) {
      document.body.classList.add('standalone');
    }


    (function(){
      if (window.top !== window.self) {
        const pdoc = window.parent.document;
        const slot = pdoc.querySelector('.calibration-tooltip');
        if (!slot) return;

        if (!slot.dataset.originalHtml) slot.dataset.originalHtml = slot.innerHTML;
        slot.classList.add('sidebar-progress');
        slot.innerHTML = `
          <div class="progress-card">
            <h3 class="progress-title">Ave Maria Progress Report</h3>
            <div class="progress-score">4.2</div>
            <div class="meter"><div class="meter-label">Pitch</div><div class="meter-track"><div class="meter-fill" style="--w:78%"></div></div></div>
            <div class="meter"><div class="meter-label">Rhythm</div><div class="meter-track"><div class="meter-fill" style="--w:64%"></div></div></div>
            <div class="meter"><div class="meter-label">Tone</div><div class="meter-track"><div class="meter-fill" style="--w:72%"></div></div></div>
          </div>
        `;


        window.addEventListener('beforeunload', () => {
          const slot2 = pdoc.querySelector('.sidebar-progress');
          if (slot2 && slot2.dataset.originalHtml != null) {
            slot2.innerHTML = slot2.dataset.originalHtml;
            slot2.classList.remove('sidebar-progress');
          }
        });
      }
    })();
  </script>

  <script>

  (function(){
    const KEY = 'rr_active_group';
    const groupEl = document.querySelector('.active-group');
    const avatars = document.querySelectorAll('.member-avatar[data-group]');

    function label(name){ return 'Active Group: ' + name; }

    const stored = localStorage.getItem(KEY);
    if (stored && groupEl) groupEl.textContent = label(stored);

    avatars.forEach(av => {
      av.style.cursor = 'pointer';
      av.addEventListener('click', () => {
        const name = av.dataset.group;
        localStorage.setItem(KEY, name);
        if (groupEl) groupEl.textContent = label(name);
        av.animate([{transform:'scale(1)'},{transform:'scale(1.1)'},{transform:'scale(1)'}], {duration:180});
      });
    });

    window.addEventListener('storage', (e) => {
      if (e.key === KEY && groupEl) groupEl.textContent = label(e.newValue || 'UMD Acapella');
    });
  })();
  </script>
</body>
</html>
